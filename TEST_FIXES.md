# راهنمای تست رفع باگ‌ها

## تغییرات انجام شده:

### 1. رفع خطای ایجاد جلسه (500 Error)
**تغییرات Backend:**
- اضافه کردن متد `create` سفارشی با error handling کامل
- اضافه کردن print statements برای دیباگ
- اضافه کردن traceback برای نمایش خطای دقیق

**تغییرات Frontend:**
- تبدیل `duration_minutes` به integer قبل از ارسال
- بهبود نمایش خطا با JSON.stringify
- اضافه کردن console.log برای دیباگ

**فایل‌های تغییر یافته:**
- `backend/api/views.py` - MeetingViewSet
- `frontend/src/pages/Meetings.jsx` - handleSubmit

### 2. رفع خطای تغییر وضعیت تسک
**تغییرات Backend:**
- جابجایی بررسی دسترسی از `get_permissions` به `check_object_permissions`
- حذف استفاده از `get_object()` در `get_permissions` که باعث خطا می‌شد

**تغییرات Frontend:**
- بهبود بررسی دسترسی قبل از ارسال درخواست
- اضافه کردن Optimistic UI Update
- برگرداندن تسک به وضعیت قبلی در صورت خطا
- بهبود نمایش خطا

**فایل‌های تغییر یافته:**
- `backend/api/views.py` - TaskViewSet
- `frontend/src/pages/Tasks.jsx` - handleDragEnd

## نحوه تست:

### تست 1: ایجاد جلسه
1. وارد صفحه جلسات شوید
2. روی دکمه "جلسه جدید" کلیک کنید
3. فرم را پر کنید:
   - عنوان: "جلسه تست"
   - تاریخ و ساعت: یک تاریخ آینده انتخاب کنید
   - مدت زمان: 60 (پیش‌فرض)
   - شرکت‌کنندگان: حداقل یک نفر انتخاب کنید
4. روی "ایجاد جلسه" کلیک کنید
5. **انتظار:** جلسه با موفقیت ایجاد شود و در لیست نمایش داده شود

**در صورت خطا:**
- Console browser را باز کنید (F12)
- خطای دقیق را مشاهده کنید
- Terminal backend را بررسی کنید برای مشاهده print statements

### تست 2: تغییر وضعیت تسک (Drag & Drop)
**تست با کاربر عادی:**
1. با یک کاربر عادی (team_member) وارد شوید
2. به صفحه تسک‌ها بروید
3. سعی کنید یک تسک خودتان را جابجا کنید
4. **انتظار:** تسک با موفقیت جابجا شود
5. سعی کنید تسک شخص دیگری را جابجا کنید
6. **انتظار:** پیام خطا نمایش داده شود

**تست با ادمین:**
1. با ادمین وارد شوید
2. به صفحه تسک‌ها بروید
3. هر تسکی را جابجا کنید
4. **انتظار:** همه تسک‌ها با موفقیت جابجا شوند

### تست 3: حذف تسک
1. با ادمین وارد شوید
2. به صفحه تسک‌ها بروید
3. روی آیکون سطل زباله کلیک کنید
4. تایید حذف را بزنید
5. **انتظار:** تسک حذف شود

## دیباگ:

### اگر هنوز خطا دارید:

#### برای خطای جلسه:
```bash
# در terminal backend:
# خطاهای زیر را جستجو کنید:
- "Meeting data received:"
- "Creating meeting with attendee_ids:"
- "Meeting created:"
- "Error in perform_create:"
```

#### برای خطای تسک:
```bash
# در Console browser:
- "Error updating task:"
- "Error response:"
```

### بررسی لاگ‌های Backend:
```bash
cd backend
# مشاهده لاگ‌های real-time
python manage.py runserver
```

### بررسی Console Browser:
1. F12 را بزنید
2. به تب Console بروید
3. خطاها را مشاهده کنید

## نکات مهم:

1. **مطمئن شوید backend در حال اجرا است:**
   - http://127.0.0.1:8000/

2. **مطمئن شوید frontend در حال اجرا است:**
   - معمولاً http://localhost:5173/

3. **Token معتبر دارید:**
   - اگر خطای 401 گرفتید، دوباره login کنید

4. **دسترسی‌ها:**
   - ادمین: همه کارها
   - اسکرام مستر: ایجاد تسک، اسپرینت، جلسه، بک‌لاگ
   - کاربر عادی: فقط تسک‌های خودش

## اگر مشکل حل نشد:

1. Backend را restart کنید
2. Frontend را refresh کنید (Ctrl+F5)
3. Cache browser را پاک کنید
4. دوباره login کنید
5. لاگ‌های دقیق را برای من ارسال کنید
